\section{Метрики оценки}

Для объективной оценки результатов работы разработанного инструментария и сравнения эффективности различных подходов к автоматическому метаморфизму кода недостаточно просто констатировать факт его изменения. Необходимо ввести количественные показатели, которые позволили бы измерить как сохранение исходной функциональности, так и достигнутый уровень усложнения и запутывания кода. Поэтому в данном исследовании был использован набор конкретных метрик, описанных ниже.

Ключевой метрикой является функциональная эквивалентность ($FE$), определяющая степень сохранения семантики программы после метаморфических преобразований. Поскольку основной принцип метаморфизма – изменение формы без изменения содержания, проверка $FE$ является обязательным шагом валидации. В данной работе $FE$ определяется как процент успешно пройденных тестов из заранее подготовленного набора, охватывающего основные сценарии использования модифицируемого кода:
\begin{equation}
FE = \frac{\text{Количество пройденных тестов}}{\text{Общее количество тестов}} \times 100\%
\end{equation}
Идеальным результатом является $FE = 100\%$, любое существенное отклонение свидетельствует о внесении семантических ошибок нейронной сетью в процессе генерации кода.

Для оценки изменения объема кода используется метрика количества строк кода ($LOC$). Хотя $LOC$ является относительно поверхностным показателем, он приобретает значение в контексте техники вставки \enquote{мертвого} кода, которая напрямую подразумевает добавление новых строк. Измеряется абсолютное изменение $\Delta LOC$ и относительное изменение $LOC_{fin}$:
\begin{equation}
\Delta LOC = LOC_{\text{metamorphic}} - LOC_{\text{original}}
\end{equation}
\begin{equation}
LOC_{fin} = \frac{\Delta LOC}{LOC_{\text{original}}} \times 100\%
\end{equation}
Значительный рост $LOC_{fin}$ ожидаем при вставке кода, однако интерпретировать его следует в комплексе с другими метриками сложности.

Для количественной оценки структурной сложности программы применяется цикломатическая сложность ($CC$), предложенная Маккейбом \cite{McCabe76Complexity}. Данная метрика основана на анализе графа потока управления и определяет количество линейно независимых путей в коде, что коррелирует с трудоемкостью тестирования. Формула расчета: 
\begin{equation}
CC = E - N + 2P
\end{equation}
где $E$ — количество рёбер в графе, $N$ — количество узлов, $P$ — количество связных компонентов. В контексте метаморфизма, особенно при модификации потока управления, ожидается рост $CC$ из-за усложнения управляющих конструкций. Рассчитывается относительное изменение:
\begin{equation}
\Delta CC = CC_{\text{metamorphic}} - CC_{\text{original}}
\end{equation}
\begin{equation}
CC_{fin} = \frac{\Delta CC}{CC_{\text{original}}} \times 100\%
\end{equation}
Положительное значение $CC_{fin}$ свидетельствует об усложнении структуры программы.

Для оценки сложности кода с точки зрения его понимания человеком-разработчиком используется когнитивная сложность ($CogC$). В отличие от $CC$, метрика $CogC$ штрафует за конструкции, прерывающие линейный поток чтения кода (условия, циклы, `goto`, рекурсия) и за их вложенность \cite{SonarSourceCogC}. Обе реализованные техники метаморфизма потенциально увеличивают $CogC$. Измеряется относительное изменение:
\begin{equation}
\Delta CogC = CogC_{\text{metamorphic}} - CogC_{\text{original}}
\end{equation}
\begin{equation}
CogC_{fin} = \frac{\Delta CogC}{CogC_{\text{original}}} \times 100\%
\end{equation}
Рост $CogC_{fin}$ интерпретируется как повышение сложности восприятия и анализа кода человеком.

Совокупность этих четырех метрик ($FE$, $LOC_{fin}$, $CC_{fin}$, $CogC_{fin}$) позволяет получить многогранную картину результатов метаморфизма, сравнивая как корректность преобразований, так и эффективность различных нейронных сетей и техник в задаче обфускации кода.
